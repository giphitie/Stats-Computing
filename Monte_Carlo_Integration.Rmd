---
title: "Monte Carlo Integration"
author: "Gifty Osei"
date: "2024-09-12"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Monte Carlo Integration 
Using to approximate integrals that are complication and the close form solution is unattainable.

## Example 1

```{r, warning=FALSE, message=FALSE}
h=function(x){(cos(50*x)+sin(20*x))^2}

par(mar=c(2,2,2,1),mfrow=c(2,1))

curve(h,xlab="Function",ylab="",lwd=2)

print(integrate(h,0,1))

x=h(runif(10^4))

estint=cumsum(x)/(1:10^4)

esterr=sqrt(cumsum((x-estint)^2))/(1:10^4)

plot(estint, xlab="Mean and error range",type="l",lwd=2,
ylim=mean(x)+20*c(-esterr[10^4],esterr[10^4]),ylab="")
lines(estint+2*esterr,col="gold",lwd=2)
lines(estint-2*esterr,col="gold",lwd=2)
```

## Standard Normal CDF

```{r}
x <- seq (.1, 2.5, length=10)
m <- 10000
u <- runif(m)
cdf <- numeric(length(x))
for (i in 1:length(x)){
g <- x[i]*exp(-(u*x[i])^2/2)
cdf[i]<-mean(g)/sqrt(2*pi)+0.5
}
Phi <- pnorm(x)
print(round(rbind(x,cdf,Phi),3))
```

