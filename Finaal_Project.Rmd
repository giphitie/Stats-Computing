---
title: "Final Project"
author: "Gifty Osei"
date: "2024-10-18"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
```


## Project Proposal

- Description
- Questions to answer
- Data set
- Statistical Computing Methods
- Enough details

- Describe research motivation, data source and structure and justify variables and statistical models to be used.


Predicting Mental Health Disorders Among Students Using Bayesian Methods and Monte Carlo Simulations

Building predictive models for mental health outcomes (depression, anxiety, and panic attacks) among students based on demographic and academic factors. The secondary objective understanding how various factors (e.g, gender, year) correlate with these mental health conditions


 ## Dataset Description
 
The dataset include these variables;
 - Demographic information : Gender, Age, Marital Status
 - Academic Factors: Course, current year of study, CGPA
 - Mental health Outcomes: Depression, anxiety, panic attacks
 - Treatment-seeking behavior : Whether student sought a specialist.
 
 
The predictors are a mix of categorical (gender, course, marital status), ordinal (year), continuous (CGPA), and binary outcomes (mental conditions).


## Statistical Methods

 * Exploratory Data Analysis
  - Descriptive Statistical Summary and Visualization (Histogram and Bar plots, Correlation Analysis)
  
 * Monte Carlo Simulation for Simulated Data
 
 * Mixture Models for Clustering
  - Using Mixture of Multivariate Normals to cluster students
  
 * Bayesian Inference and Laplace Approximation
  - Posterior Distribution
  - Laplace to approximate the posterior distribution

 * Monte Carlo Optimization

 * EM Algorithm for missing Data
 
 
This project will allow to leverage a variety of statistical computing methods, offering a solid framework for analysis and valuable insights into mental health among students

## Explore interesting structure

```{r}
Data_all <- read.csv("D:/WashU/First Year/Sem1/SDS5531_StatsComputing/Final_Project/Big_Cities_Health_Data_Inventory.csv")%>% mutate(Gender = as.factor(Gender), Race..Ethnicity = as.factor(Race..Ethnicity), Indicator.Category = as.factor(Indicator.Category), Indicator = as.factor(Indicator), Value = as.numeric(Value),Place = as.factor(Place)) 

# Year  =  as.numeric(Year)-2010
```



```{r}
Data <- read.csv("D:/WashU/First Year/Sem1/SDS5531_StatsComputing/Final_Project/Big_Cities_Health_Data_Inventory.csv") %>% filter(Indicator == "All Types of Cancer Mortality Rate (Age-Adjusted; Per 100,000 people)")%>% mutate(Gender = as.factor(Gender), Race..Ethnicity = as.factor(Race..Ethnicity), Indicator.Category = as.factor(Indicator.Category), Indicator = as.factor(Indicator), Year = as.numeric(Year), Value = as.numeric(Value),Place = as.factor(Place)) 
```

```{r}
Data1 <- read.csv("D:/WashU/First Year/Sem1/SDS5531_StatsComputing/Final_Project/Big_Cities_Health_Data_Inventory.csv") %>% filter(Indicator == "All-Cause Mortality Rate (Age-Adjusted; Per 100,000 people)")%>% mutate(Gender = as.factor(Gender), Race..Ethnicity = as.factor(Race..Ethnicity), Indicator.Category = as.factor(Indicator.Category), Indicator = as.factor(Indicator), Year = as.numeric(Year), Value = as.numeric(Value),Place = as.factor(Place)) 
```


```{r}

# Histogram with density plot
ggplot(data = Data) +
  geom_histogram(aes(x = Value, y = ..density..), bins = 30, fill = 'skyblue', alpha = 0.5) +
  theme_bw()

ggplot(data = Data1) +
  geom_histogram(aes(x = Value, y = ..density..), bins = 30, fill = 'skyblue', alpha = 0.5) +
  theme_bw()

Data_all$Value <- log(Data_all$Value)

ggplot(data = Data_all) +
  geom_histogram(aes(x = Value, y = ..density..), bins = 100, fill = 'skyblue', alpha = 0.5) +
  theme_bw()


ggplot(data = Data_all, aes(x = Year, y = Value, color = Gender))+
  geom_point(alpha = 0.3)  + xlab("Year Starting from 2010")+
  ylab("Value") + ggtitle("Relationship Between Year and Response Value")+
  theme(axis.text.x = element_text(angle = 90, hjust = 1, size=8))

```

## Table
```{r}
table(Data_all$Indicator.Category)
```


This shows that analysis on the entire data will be challenging, so do in groups
## Clustering Assessment
```{r}
# K-means clustering

kmeans_result <- kmeans(Data_all$Value, centers = 100)
data$cluster <- as.factor(kmeans_result$cluster)

# Visualize clusters
ggplot(data, aes(x = var1, y = var2, color = cluster)) +
  geom_point() +
  theme_minimal()

```

